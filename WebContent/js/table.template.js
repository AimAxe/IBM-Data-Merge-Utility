
/*
 * Editor client script for DB table template
 * Automatically generated by http://editor.datatables.net/generator
 */
  
(function($){

$(document).ready(function() {
	var editor = new $.fn.dataTable.Editor( {
		"ajax": "php/table.template.php",
		"table": "#template",
		"fields": [
			{
				"label": "Collection",
				"name": "template.idcollection",
				"type": "select",
			},
			{
				"label": "Column Value",
				"name": "template.columnValue",
				"type": "text"
			},
			{
				"label": "Template Name",
				"name": "template.name",
				"type": "text"
			},
			{
				"label": "Type",
				"name": "template.type",
				"type": "select",
			},
			{
				"label": "Output",
				"name": "template.output",
				"type": "text"
			},
			{
				"label": "Description",
				"name": "template.description",
				"type": "text"
			},
			{
				"label": "Content",
				"name": "template.content",
				"type": "textarea"
			}
		]
	} );

	$('#template').dataTable( {
		"dom": "Tfrtip",
		"ajax": "php/table.template.php",
		"columns": [
			{"data": "collection.name"},
			{"data": "template.columnValue"},
			{"data": "template.name"},
			{"data": "codesTtype.meaning"},
			{"data": "template.description"},
		],
		"tableTools": {
			"sRowSelect": "os",
			"fnRowSelected": function ( nodes ) {setTemplate(templateTable, nodes);},			
			"aButtons": [
				{ "sExtends": "editor_create", "editor": editor },
				{ "sExtends": "editor_edit",   "editor": editor },
				{ "sExtends": "editor_remove", "editor": editor }
			]
		}
	} );
	templateTable = $('#template').DataTable();

	function setTemplate(table, nodes) {
		theTemplate = table.row(nodes).data().template.idtemplate;
		var theName = table.row(nodes).data().template.name;
		var event = new CustomEvent('templateSet');
		$( ".listener" ).trigger( "templateSet", [theName, theTemplate]  );
	}
	
	$('#searchCollection').on( 'keyup', function () {
	    hostTable
	        .columns( 0 )
	        .search( this.value )
	        .draw();
	} );
	
	$('#searchColumn').on( 'keyup', function () {
	    hostTable
	        .columns( 1 )
	        .search( this.value )
	        .draw();
	} );

} );

}(jQuery));

